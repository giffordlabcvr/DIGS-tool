<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>DIGS Tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../assets/stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="../assets/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="../assets/stylesheets/github-light.css" media="screen">

  </head>
  
  <body>
    <section class="page-header">
    
      <h1 class="project-name">The DIGS Tool</h1>
      <h2 class="project-tagline">Explore genomes interactively using BLAST and a relational database.</h2>
      
      <a href="../index.html" class="btn">Home</a>
      <a href="https://github.com/giffordlabcvr/DIGS-tool/wiki/Installation-and-Setup" class="btn">User Guide</a>
      <a href="https://github.com/giffordlabcvr/DIGS-tool/zipball/master" class="btn">Download</a>
      <a target="_blank" href="https://github.com/giffordlabcvr/DIGS-tool" class="btn">View on GitHub</a>
      <a target="_blank" href="https://twitter.com/DigsTool" class="btn">Twitter</a>
      
    </section>

    <section class="main-content">


	   <h3>
		 <a id="taxonomyOverview" class="anchor" href="#sequenceData" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>Setting up a local copy of the NCBI taxonomy database</strong>
	   </h3>
       <hr>


	   <p>
		  This document describes how to set up a copy of the NCBI taxonomy database in MySQL.
 	   </p>

	   <p>
		  First download and upack the taxonomy DB from the NCBI FTP server.
 <pre>
 <code>wget ftp://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz 
 gunzip taxdump.tar.gz
 tar -xvf taxdump.tar</code></pre>		
 	   </p>


       <br>
	   <h3>
		 <a id="CreatingTables" class="anchor" href="#Background" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>Creating the database tables in MySQL</strong>
	   </h3>
       <hr>



		 <p>
           Load the schema into a MySQL database.
 <pre>
 <code>CREATE DATABASE NCBI_Taxonomy;

  USE NCBI_Taxonomy;

  CREATE TABLE `ncbi_names` (
	`tax_id` mediumint(11) unsigned NOT NULL default '0',
	`name_txt` varchar(255) NOT NULL default '',
	`unique_name` varchar(255) default NULL,
	`name_class` varchar(32) NOT NULL default '',
	KEY `tax_id` (`tax_id`),
	KEY `name_class` (`name_class`),
	KEY `name_txt` (`name_txt`)
  );


  CREATE TABLE `ncbi_nodes` (
	`tax_id` mediumint(11) unsigned NOT NULL default '0',
	`parent_tax_id` mediumint(8) unsigned NOT NULL default '0',
	`rank` varchar(32) default NULL,
	`embl_code` varchar(16) default NULL,
	`division_id` smallint(6) NOT NULL default '0',
	`inherited_div_flag` tinyint(4) NOT NULL default '0',
	`genetic_code_id` smallint(6) NOT NULL default '0',
	`inherited_GC_flag` tinyint(4) NOT NULL default '0',
	`mitochondrial_genetic_code_id` smallint(4) NOT NULL default '0',
	`inherited_MGC_flag` tinyint(4) NOT NULL default '0',
	`GenBank_hidden_flag` smallint(4) NOT NULL default '0',
	`hidden_subtree_root_flag` tinyint(4) NOT NULL default '0',
	`comments` varchar(255) default NULL,
	PRIMARY KEY  (`tax_id`),
	KEY `parent_tax_id` (`parent_tax_id`)
  );</code></pre>		 

          That should do it - to check....

  		 </p>


       <br>
	   <h3>
		 <a id="PopulateDatabase" class="anchor" href="#Background" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>Populating the database</strong>
	   </h3>
       <hr>

		 <p>

We now load the node and name dumps into our database. The trick is to do this from the command line, and make sure MySQL can access the directory the *.dmp files are in.

 
  <pre>
  <code>LOAD DATA INFILE '/Users/rob/names.dmp' 
  INTO TABLE ncbi_names 
  FIELDS TERMINATED BY '\t|\t' 
  LINES TERMINATED BY '\t|\n' 
  (tax_id, name_txt, unique_name, name_class);</code></pre>		   


  		 </p>

		 <p>
Allow a little time for the data to upload.

Next load the nodes:
 
  <pre>
  <code>LOAD DATA INFILE '/Users/rob/nodes.dmp' 
  INTO TABLE ncbi_nodes 
  FIELDS TERMINATED BY '\t|\t' 
  LINES TERMINATED BY '\t|\n' 
  (tax_id, parent_tax_id,rank,embl_code,division_id,
  inherited_div_flag,genetic_code_id,inherited_GC_flag,
  mitochondrial_genetic_code_id,inherited_MGC_flag,
  GenBank_hidden_flag,hidden_subtree_root_flag,comments);</code></pre>		   


  		 </p>


	 <footer class="site-footer">
	   <span class="site-footer-owner"><a href="https://github.com/giffordlabcvr/DIGS-tool">DIGS</a> is maintained by <a href="https://github.com/giffordlabcvr">giffordlabcvr</a>.</span>

	   <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
	 </footer>


    </section>


  </body>
  
</html>
