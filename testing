[H[2J


	######################################################################
	#                                                                    #
	#                  DIGS (version: $version_num) 1.1                  #
	#                Database-Integrated Genome Screening                #
	#                         Robert J. Gifford                          #
	#                   <robert.gifford@glasgow.ac.uk>                   #
	#                                                                    #
	######################################################################



	 ### Running DIGS tests ~ + ~ + ~ 

	 ### TEST 1: Running live nucleotide screen against synthetic data ~ + ~ + ~ 

	  Connecting to DB:  digs_test_screen
	  Probes:            1 nucleic acid FASTA sequences
	  Reference library: 1 nucleic acid sequences
	  Targets:           1 target files
	  Searches to run    1

	 ### Starting database-integrated genome screening

	  blastn: 1: 'fake_species' (fake_version, fake_datatype)
	  target: 'artificial_test1_korv.fa'
	  probe:  'KoRV_LTR'
		 # 2 matches to probe: KoRV, LTR
		 # 0 previously extracted loci
		 # 2 new hits + previously extracted loci in this target file 
		    - Defragment calculation 'artificial_with_korv_ltr': '10967'-'703' = 10264
		 # 2 newly extracted sequences for assign/reassign
		    - Extracted sequence: 504 nucleotides 
		    - Extracted sequence: 504 nucleotides 
		    - Classified sequence as 'KoRV (LTR)'
		    - Classified sequence as 'KoRV (LTR)'
		 # 2 extracted sequences classified
		 # 0 cross-matched to something other than the probe
		 # done 1 of 1 queries (%100.00)

	  Live blastn screen test: ** PASSED **

	 ### TEST 2: Try to defragment results (should not work) ~ + ~ + ~ 

		    - Defragment calculation 'artificial_with_korv_ltr': '10967'-'703' = 10264
	  Defragment negative test: ** PASSED **

	 ### TEST 3: Running live gag & pol peptide screen against synthetic data ~ + ~ + ~ 

	  Probes:            2 amino acid FASTA sequences
	  Reference library: 2 amino acid sequences
	  Targets:           1 target files
	  Searches to run    2

	 ### Starting database-integrated genome screening

	  tblastn: 1: 'fake_species' (fake_version, fake_datatype)
	  target: 'artificial_test1_korv.fa'
	  probe:  'KoRV_gag'
		 # 6 matches to probe: KoRV, gag
		 # 1 matches above threshold (excluded 1 < length; 5 < bitscore)
		 # 2 previously extracted loci
		 # 3 new hits + previously extracted loci in this target file 
		    - Defragment calculation 'artificial_with_korv_ltr': '4001'-'703' = 3298
		    - Defragment calculation 'artificial_with_korv_ltr': '10967'-'5566' = 5401
	#~o~ ~o~ ~o~ ~o~ ~o~ ~o~# Showing Hash Contents 

	scaffold => artificial_with_korv_ltr
	probe_type => UTR
	gap_openings => 				>>> UNDEFINED <<<
	orientation => +
	subject_end => 703
	bitscore => 905
	digs_result_id => 1
	query_start => 1
	probe_name => KoRV
	target_name => artificial_test1_korv.fa
	mismatches => 5
	organism => fake_species
	query_end => 504
	align_len => 504
	record_id => 4
	target_version => fake_version
	probe_gene => LTR
	identity => 99.01
	evalue_num => 				>>> UNDEFINED <<<
	subject_start => 200
	target_datatype => fake_datatype
	evalue_exp => 1

		    - Extending locus: , : (200-703) 
	#~o~ ~o~ ~o~ ~o~ ~o~ ~o~# Showing Hash Contents 

	scaffold => artificial_with_korv_ltr
	probe_type => UTR
	gap_openings => 				>>> UNDEFINED <<<
	orientation => +
	subject_end => 11470
	bitscore => 911
	digs_result_id => 2
	query_start => 1
	probe_name => KoRV
	target_name => artificial_test1_korv.fa
	mismatches => 4
	organism => fake_species
	query_end => 504
	align_len => 504
	record_id => 5
	target_version => fake_version
	probe_gene => LTR
	identity => 99.21
	evalue_num => 				>>> UNDEFINED <<<
	subject_start => 10967
	target_datatype => fake_datatype
	evalue_exp => 1

		    - Extending locus: , : (10967-11470) 
		 # 3 newly extracted sequences for assign/reassign
		    - Extracted sequence: 504 nucleotides 
		    - Extracted sequence: 504 nucleotides 
		    - Extracted sequence: 1566 nucleotides 
		    - Classified sequence as 'KoRV (LTR)'
		    - Classified sequence as 'KoRV (LTR)'
		    - Classified sequence as 'KoRV (gag)'
		 # 3 extracted sequences classified
		 # 2 cross-matched to something other than the probe
		 # done 1 of 2 queries (%50.00)

	  tblastn: 2: 'fake_species' (fake_version, fake_datatype)
	  target: 'artificial_test1_korv.fa'
	  probe:  'KoRV_pol'
		 # 2 matches to probe: KoRV, pol
		 # 1 matches above threshold (excluded 0 < length; 1 < bitscore)
		 # 5 previously extracted loci
		 # 6 new hits + previously extracted loci in this target file 
		    - Defragment calculation 'artificial_with_korv_ltr': '200'-'703' = -503
		      - Merged this pair
		    - Defragment calculation 'artificial_with_korv_ltr': '4001'-'703' = 3298
		    - Defragment calculation 'artificial_with_korv_ltr': '5681'-'5566' = 115
		    - Defragment calculation 'artificial_with_korv_ltr': '10967'-'9064' = 1903
		    - Defragment calculation 'artificial_with_korv_ltr': '10967'-'11470' = -503
		      - Merged this pair
		    - Merging previously extracted loci: (4,2)
		    - Merging previously extracted loci: (1,3)
	#~o~ ~o~ ~o~ ~o~ ~o~ ~o~# Showing Hash Contents 

	scaffold => artificial_with_korv_ltr
	probe_type => ORF
	gap_openings => 				>>> UNDEFINED <<<
	orientation => +
	subject_end => 5566
	bitscore => 947
	digs_result_id => 5
	query_start => 1
	probe_name => KoRV
	target_name => artificial_test1_korv.fa
	mismatches => 				>>> UNDEFINED <<<
	organism => fake_species
	query_end => 1566
	align_len => 522
	record_id => 9
	target_version => fake_version
	probe_gene => gag
	identity => 100
	evalue_num => 				>>> UNDEFINED <<<
	subject_start => 4001
	target_datatype => fake_datatype
	evalue_exp => 1

		    - Extending locus: , : (4001-5566) 
		 # 4 newly extracted sequences for assign/reassign
		    - Extracted sequence: 504 nucleotides 
		    - Extracted sequence: 504 nucleotides 
		    - Extracted sequence: 3384 nucleotides 
		    - Extracted sequence: 1566 nucleotides 
		    - Classified sequence as 'KoRV (LTR)'
		    - Classified sequence as 'KoRV (LTR)'
		    - Classified sequence as 'KoRV (pol)'
		    - Classified sequence as 'KoRV (gag)'
		 # 4 extracted sequences classified
		 # 3 cross-matched to something other than the probe
		 # done 2 of 2 queries (%100.00)